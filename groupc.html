<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Group C Previous Year Questions — Mock Test (Shuffled, Bilingual)</title>
  <style>
    :root{
      --bg:#f6fbff; --card:#fff; --accent:#0b5cff; --muted:#556;
      --correct:#0bb15a; --correct-strong:#067a3a; --wrong:#ff4d4f; --wrong-strong:#b21f1f;
      --shadow:0 12px 30px rgba(11,92,255,0.06);
      font-family:"Noto Sans Bengali", "Noto Sans", Roboto, Arial, sans-serif;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#f0f6ff,#ffffff);color:#102030}
    .wrap{max-width:1100px;margin:18px auto;padding:16px}
    /* sticky header */
    header{
      position:sticky;
      top:0;
      z-index:40;
      backdrop-filter: blur(6px);
      background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.9));
      border-bottom:1px solid #eef4ff;
      display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 16px;border-radius:8px;
      box-shadow:0 6px 24px rgba(3,102,214,0.04);
    }
    h1{font-size:18px;margin:0;color:var(--accent)}
    .meta{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .timer{font-weight:700;color:#08306b;background:#eaf3ff;padding:8px 12px;border-radius:10px;box-shadow:var(--shadow)}
    .startTop{display:flex;gap:10px;align-items:center}
    .btn{background:var(--accent);color:#fff;padding:8px 12px;border:none;border-radius:8px;cursor:pointer;font-weight:700}
    .btn:disabled{opacity:0.55;cursor:default}
    form{margin-top:16px;background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow)}
    .q{margin-bottom:12px;padding:12px;border-radius:10px;border:1px solid #eef4ff;background:linear-gradient(180deg,rgba(11,92,255,0.02),transparent)}
    .qnum{font-weight:700;margin-bottom:8px}
    .opts{display:flex;flex-direction:column;gap:8px}
    label.opt{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;border:1px solid transparent;cursor:pointer;transition:transform .08s,box-shadow .08s}
    label.opt:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(3,102,214,0.08)}
    input[type="radio"]{accent-color:var(--accent);transform:scale(1.05)}
    .statusBar{display:flex;gap:12px;align-items:center;margin-top:12px;flex-wrap:wrap}
    .infoBox{background:#f7f9ff;padding:8px 10px;border-radius:8px;border:1px solid #e6f0ff}
    .results{margin-top:14px;padding:12px;border-radius:10px;background:#fbffef;border:1px solid #eef6e8;display:none}
    .is-correct{
      background:linear-gradient(90deg, rgba(11,177,90,0.12), rgba(11,177,90,0.06));
      border:2px solid rgba(6,122,58,0.9); color:var(--correct-strong);
      box-shadow: 0 8px 28px rgba(6,122,58,0.06);
    }
    .is-wrong{
      background:linear-gradient(90deg, rgba(255,77,79,0.12), rgba(255,77,79,0.06));
      border:2px solid rgba(178,31,31,0.95); color:var(--wrong-strong);
      box-shadow: 0 8px 28px rgba(178,31,31,0.06);
    }
    .small{font-size:13px;color:var(--muted)}
    /* keep top header compact on small screens */
    @media(max-width:820px){header{flex-direction:column;align-items:flex-start}}
    /* slight spacing for bilingual English lines */
    .bilingual{display:block;color:#123; margin-top:4px;font-size:13px}
    .eng{color:#0b5cff;font-weight:600}
    .bn{color:#08306b}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Group C Previous Year Questions</h1>
        <div class="small">Correct answers strongly green; wrong selections strongly red. Options randomized per question.</div>
      </div>

      <div class="meta">
        <div class="startTop">
          <button id="startBtn" class="btn">Start Timer</button>
          <div class="timer" id="timer">60:00</div>
        </div>
        <div class="statusBar">
          <div class="infoBox"><strong id="status">Not started</strong></div>
          <div class="infoBox small">Total Questions: <strong id="totalQ">60</strong></div>
          <div class="infoBox small">Attempted: <strong id="attempted">0</strong></div>
          <div class="infoBox small">Correct: <strong id="correctCountTop">0</strong></div>
          <div class="infoBox small">Wrong: <strong id="wrongCountTop">0</strong></div>
        </div>
      </div>
    </header>

    <form id="quizForm" autocomplete="off" novalidate>
      <div id="questions"></div>

      <div style="display:flex;gap:12px;align-items:center;margin-top:12px;flex-wrap:wrap">
        <button type="submit" id="submitBtn" class="btn" disabled>Submit Answers</button>
        <div class="small">Time taken (minutes): <strong id="timeTaken">0.00</strong></div>
        <div class="small">Marks scored: <strong id="marksScored">0</strong></div>
      </div>

      <div id="resultArea" class="results" role="status" aria-live="polite">
        <div class="small">You answered <strong id="attemptedRes">0</strong> questions; <strong id="correctRes">0</strong> correct, <strong id="wrongRes">0</strong> wrong.</div>
        <div class="small" id="detailedMsg"></div>
      </div>
    </form>
  </div>

  <script>
    // original quiz items with correct 'text' value indicated by keyText
    const originalQuiz = [
      {q:"1. ডিটকেবিয়া অনভভাউন ত্যশাসন অবশ্য", opts:["A","B","C","D"], keyText:"A"},
      {q:"2. বায়ুগামী পরিস্থিতিতে সর্বাধিক পরিমাণে থাকা গ্যাস হল", opts:["অক্সিজেন","—","হাইড্রোজেন","নাইট্রোজেন"], keyText:"নাইট্রোজেন"},
      {q:"3. মানবজাতির কোষে ক্রোমোজোমের সংখ্যা হল", opts:["44","48","46","23"], keyText:"46"},
      {q:"4. নাগ রুল — একটি চাষাবাদ পদ্ধতি", opts:["কা তানাকনৃণ","বনাড়া নмиব নাম","একডি টেনআদি","খবরগাড়ে কারসন ভমনিঃ"], keyText:"একডি টেনআদি"},
      {q:"5. ‘বিশ্ব দিবস’ পালন করা হয়", opts:["5ই জুন","22শে এপ্রিল","16ই সেপ্টেম্বর","12ই মে"], keyText:"5ই জুন"},
      {q:"6. ভিটামিন A-এর অভাবে হওয়া রোগ হল", opts:["রাতের অন্ধত্ব","রিকেটস","স্কার্ভি","চুল পড়া"], keyText:"রাতের অন্ধত্ব"},
      {q:"7. হিমোগ্লোবিনের কাজ হল", opts:["অক্সিজেন পরিবহন করা","ব্যাকটেরিয়া ধ্বংস করা","রক্তাল্পতা প্রতিরোধ করা","শক্তি ব্যবহার করা"], keyText:"অক্সিজেন পরিবহন করা"},
      {q:"8. JPEG মানে কী", opts:["Joy Prakash Energy Group","Joint Photographic Extension Group","Joint Photographic Experts Group","Joint Programming for Ecological Goal"], keyText:"Joint Photographic Experts Group"},
      {q:"9. আলফ্রেড নোবেল আবিষ্কার করেছিলেন", opts:["এক্স-রে","ডীজেল ইঞ্জিন","ডায়নামাইট","ডাইনামো"], keyText:"ডায়নামাইট"},
      {q:"10. মাউন্ট এভারেস্ট অবস্থিত", opts:["ভারত","চীন","নেপাল","ভুটান"], keyText:"নেপাল"},
      {q:"11. ‘রামসার সাইট’ যুক্ত ফিচার হল", opts:["জলাভূমি","তৃণভূমি","বনাঞ্চল","উপত্যকা"], keyText:"জলাভূমি"},
      {q:"12. 'CNG' এর পূর্ণরূপ", opts:["Converted Natural Gas","Conduced Natural Gas","Compressed Natural Gas","কমরথম্ড নাজওয়ান গাম"], keyText:"Compressed Natural Gas"},
      {q:"13. মানুষের ক্ষেত্রে হাড়ের সংখ্যা", opts:["208","206","209","204"], keyText:"206"},
      {q:"14. এলোরা গুহা কোন রাজ্যে অবস্থিত", opts:["মধ্যপ্রদেশ","তামিলনাড়ু","মহারাষ্ট্র","উত্তরপ্রদেশ"], keyText:"মধ্যপ্রদেশ"},
      {q:"15. নিম্নলিখিত বনাঞ্চলগুলোর মধ্যে কোনটি পশ্চিমবঙ্গে অবস্থিত নেই", opts:["গোরুমারা","মানাস","সুন্দরবন","চ্যাপ্রমারি"], keyText:"মানাস"},
      {q:"16. উপন্যাস আনন্দমঠ-এর রচয়িতা", opts:["মধুসূদন দত্ত","স্বামী বিবেকানন্দ","নবীনচন্দ্র সেন","বঙ্কিমচন্দ্র চট্টোপাধ্যায়"], keyText:"বঙ্কিমচন্দ্র চট্টোপাধ্যায়"},
      {q:"17. কোন দেশে ক্রিসমাস গ্রীষ্মে উদ্‌যাপিত হয়", opts:["যুক্তরাষ্ট্র","কানাডা","গ্রেট ব্রিটেন","অস্ট্রেলিয়া"], keyText:"অস্ট্রেলিয়া"},
      {q:"18. 2014 সালে কোন নেতাকে পরোক্ষে ভারতরত্ন প্রদান করা হয়েছিল", opts:["ভালভভাই প্যাটেল","মৌলানা আবুল কালাম আজাদ","গোপীনাথ বরদোলoi","মহাত্মা গান্ধী"], keyText:"ভালভাই প্যাটেল"},
      {q:"19. তেলেঙ্গানা রাজ্য গঠিত হয়েছিল", opts:["2011","2012","2013","2014"], keyText:"2014"},
      {q:"20. আপেক্ষিকতার তত্ত্বের সাথে সংশ্লিষ্ট বিজ্ঞানী", opts:["নিলস বোহর","হেইসেনবার্গ","আইনস্টাইন","ম্যাডাম কুরি"], keyText:"আইনস্টাইন"},
      {q:"21. 26শে নভেম্বর 2014-এ 18তম SAARC শীর্ষ সম্মেলন কোথায় অনুষ্ঠিত হয়", opts:["ইসলামাবাদ","কাঠমাণ্ডু","ঢাকা","কলম্বো"], keyText:"কাঠমাণ্ডু"},
      {q:"22. 13 অগাস্ট 2014-এ পরিকল্পনা কমিশনের পরিবর্তে প্রতিষ্ঠিত সংস্থা", opts:["NITI Aayog","National Development Council","Finance Commission","CAG"], keyText:"NITI Aayog"},
      {q:"23. ভারতের আইসিবিএম — country's maiden nuclear-capable ICBM", opts:["আকাশ","পৃথিভী-III","অগ্নি-V","ব্রহ্মস"], keyText:"অগ্নি-V"},
      {q:"24. country's 13th major port হবে", opts:["পোর্ট ব্লেয়ার","প্যারাডুইপ","এনையেম","কোচি"], keyText:"প্যারাডুইপ"},
      {q:"25. রজার ফেডারার সম্পর্কিত ক্রীড়া", opts:["ব্যাডমিন্টন","হকি","টেনিস","ফুটবল"], keyText:"টেনিস"},
      {q:"26. NASA-এর spacecraft orbiting Jupiter is", opts:["গ্যালিলিও","ইউরোপা","জুনো","ডন"], keyText:"জুনো"},
      {q:"27. মোহেঞ্জোদারোর ধ্বংসাবশেষ কে আবিষ্কার করেছিলেন", opts:["জন মার্শাল","দয়াৰাম সাহনী","রখালদাস বন্দ্যোপাধ্যায়","বি. বি. লাল"], keyText:"জন মার্শাল"},
      {q:"28. সর্বশেষ গঠিত ভারতীয় রাজ্য কোনটি", opts:["ছত্তিশগড়","ঝাড়খণ্ড","উত্তরাখণ্ড","তেলেঙ্গানা"], keyText:"তেলেঙ্গানা"},
      {q:"29. ভারতের জাতীয় পাখি হল", opts:["ঈগল","—","ময়ূর","আইবিস"], keyText:"ময়ূর"},
      {q:"30. মৈত্রী এক্সপ্রেস II চলবে", opts:["কলকাতা - ঢাকা","কলকাতা - খুলনা","কলকাতা - বরিশাল","কলকাতা - রাজশাহী"], keyText:"কলকাতা - ঢাকা"},

      /* English section 31-45 will be shown bilingually in render step */
      {q:"31. \"I regret to inform you that\" starts a letter indicating", opts:["দুঃখজনক সংবাদ","একটি প্রত্যাখ্যান","একটি গ্রহণ","একটি জরুরি বিষয়"], keyText:"দুঃখজনক সংবাদ"},
      {q:"32. Correction in: 'Another baffling change that I notice in him nowadays is that he avoids to speak to me.'", opts:["a","b","c","d"], keyText:"c"},
      {q:"33. 'Write an abstract of this essay.' meaning of underlined word", opts:["summary","title","plan","conclusion"], keyText:"summary"},
      {q:"34. Choose the correct sentence", opts:["To be intelligent is more essential than being hard-working","Being intelligent is more important than to be hard-working","For one to be intelligent is more important than being hard-working","Being intelligent is more essential than being hard-working"], keyText:"Being intelligent is more essential than being hard-working"},
      {q:"35. 'Would you mind moving the car?' this sentence is a", opts:["প্রশ্ন","বিনীত অনুরোধ","পরামর্শ","সুপারিশ"], keyText:"বিনীত অনুরোধ"},
      {q:"36. 'What is the time _ your watch?' correct preposition is", opts:["in","by","on","at"], keyText:"at"},
      {q:"37. Correction in: 'I will try to be on time but do not worry when I am late.'", opts:["a","b","c","d"], keyText:"d"},
      {q:"38. Meaning of 'humble' here is", opts:["weak","cowardly","insignificant","meek"], keyText:"meek"},
      {q:"39. Synonym for the verb in 'One or two stars were still in the sky.'", opts:["burning","turning","twinkling","tinkling"], keyText:"twinkling"},
      {q:"40. Sentence type of 'The boys who wanted to play football were disappointed when it rained.'", opts:["complex sentence","compound sentence","simple sentence","mixed sentence"], keyText:"complex sentence"},
      {q:"41. Antonym of 'trivial' is", opts:["important","insignificant","futile","fast"], keyText:"important"},
      {q:"42. A group of elephants is called", opts:["collection","herd","school","litter"], keyText:"herd"},
      {q:"43. Choose the correct sentence", opts:["Bhupen do not know the way","Bhupen do not knows the way","Bhupen did not knows the way","Bhupen does not know the way"], keyText:"Bhupen does not know the way"},
      {q:"44. Rahim's doctor advised him to _ as a cure for his sore throat.", opts:["babble","gargle","giggle","gurgle"], keyText:"gargle"},
      {q:"45. In place of underlined part, correct phrasal verb is", opts:["hold on","give out","make out","give away"], keyText:"make out"},
      {q:"46. দৈর্ঘ্য 15% বাড়ে ও প্রস্থ 15% কমে ক্ষেত্রফলের শতাংশ পরিবর্তন", opts:["3% বৃদ্ধি","3.22% হ্রাস","4% বৃদ্ধি","2.1% হ্রাস"], keyText:"3.22% হ্রাস"},
      {q:"47. 1.7, 0.51 এবং 0.153 সংখ্যাগুলোর H.C.F. কত?", opts:["0.17","1.7","0.017","0.0017"], keyText:"0.017"},
      {q:"48. ঘড়িটির বিক্রয়মূল্য কত হবে?", opts:["Rs. 290","Rs. 300","Rs. 350","Rs. 270"], keyText:"Rs. 300"},
      {q:"49. মূল Rs.620; MP-25%; বিক্রি 15% ডিসকাউন্টে; লাভের শতাংশ?", opts:["122%","134%","112%","142%"], keyText:"112%"},
      {q:"50. 16 মেশিন 27 দিনে 1000 পার্টস; 2 মেশিন বাড়ালে কাজ কত দিন কমে?", opts:["3 দিন","7 দিন","2 দিন","4 দিন"], keyText:"4 দিন"},
      {q:"51. (ছেড়ে দেয়া)", opts:["Option1","Option2","Option3","Option4"], keyText:"Option1"},
      {q:"52. (4)^0.5 × (0.5)^4 × 24 এর মান কত?", opts:["1/4","1","2","1/8"], keyText:"1/4"},
      {q:"53. পাঁচটি ঘণ্টার বিরতি 9,6,4,10,8 সেকেন্ড; এক ঘন্টায় কতবার একসাথে বাজবে?", opts:["11 বার","8 বার","12 বার","9 বার"], keyText:"11 বার"},
      {q:"54. ক্ষুদ্রতর সংখ্যা 5..9 দিয়ে ভাগ করলে অবশিষ্ট 4,5,6,7,8 হবে — সংখ্যা কত?", opts:["2519","5039","1079","979"], keyText:"2519"},
      {q:"55. Rs.500-এ 40% ছাড় ও ক্রমাগত 36% ও 4% ছাড়ের পার্থক্য?", opts:["Rs.2","Rs.7.20","Re.0","Rs.18"], keyText:"Rs.7.20"},
      {q:"56. A Rs.1200 5মাস; B Rs.750 4মাস; মুনাফা Rs.450; অনুপাত?", opts:["3:2","5:3","2:1","4:3"], keyText:"5:3"},
      {q:"57. পুনরাবৃত্ত দশমিক 0.84181 -> denominator - numerator?", opts:["29","87","67","13"], keyText:"29"},
      {q:"58. 14 জন 12 দিনে; 8 দিনে আরও কতজন দরকার?", opts:["9 জন","7 জন","3 জন","6 জন"], keyText:"9 জন"},
      {q:"59. 10%,20%,30% ধারাবাহিক ছাড়ের সমতুল্য একক ছাড় কত?", opts:["45.4%","49.6%","52.7%","58.2%"], keyText:"49.6%"},
      {q:"60. 70m ট্রেন + 105m ব্রিজ; 75 km/h গতিতে পার হতে সময়?", opts:["4 সেকেন্ড","5 সেকেন্ড","3.5 সেকেন্ড","7 সেকেন্ড"], keyText:"5 সেকেন্ড"}
    ];

    // shuffle helper
    function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

    // Build a rendered quiz where options are shuffled and we keep correct index reference
    const quiz = originalQuiz.map(item=>{
      const opts = item.opts.map(text=>({text}));
      shuffleArray(opts);
      let correctIndex = opts.findIndex(o => String(o.text).trim().toLowerCase() === String(item.keyText).trim().toLowerCase());
      if(correctIndex === -1 && typeof item.keyText === 'string' && /^[A-D]$/i.test(item.keyText.trim())){
        const labelMap = {'A':0,'B':1,'C':2,'D':3};
        const origIndex = labelMap[item.keyText.trim().toUpperCase()];
        const origText = item.opts[origIndex];
        correctIndex = opts.findIndex(o => String(o.text).trim().toLowerCase()===String(origText).trim().toLowerCase());
      }
      if(correctIndex === -1) correctIndex = 0;
      return { q: item.q, options: opts, correctIndex, keyText: item.keyText };
    });

    // render questions with bilingual English for items 31-45
    const container = document.getElementById('questions');
    quiz.forEach((item,i)=>{
      const idx = i+1;
      const sec = document.createElement('section'); sec.className='q'; sec.id='q'+idx;
      const num = document.createElement('div'); num.className='qnum';
      // If question index between 31 and 45, show bilingual: English line then Bengali line
      if(idx>=31 && idx<=45){
        // derive an English short version if original q contains English; else reuse
        const engText = item.q.includes('"') ? item.q : item.q; // keep simple
        num.innerHTML = `${idx}. <span class="eng">${engText}</span><span class="bilingual bn">${convertToBengaliLine(item.q)}</span>`;
      } else {
        num.textContent = `${idx}. ${item.q}`;
      }
      sec.appendChild(num);
      const opts = document.createElement('div'); opts.className='opts';
      const letters = ['A','B','C','D'];
      item.options.forEach((optObj,j)=>{
        const id = `q${idx}_opt${j}`;
        const lab = document.createElement('label');
        lab.className='opt';
        lab.setAttribute('for', id);
        lab.innerHTML = `<input type="radio" name="q${idx}" id="${id}" value="${j}"> <span><strong>${letters[j]}</strong>. ${optObj.text}</span>`;
        opts.appendChild(lab);
      });
      sec.appendChild(opts);
      container.appendChild(sec);
    });

    // Helper to create a Bengali line for English questions (simple mapping / reuse)
    function convertToBengaliLine(orig){
      // If orig already Bengali heavy, show as-is; else provide a short Bengali translation
      // This is a lightweight deterministic translator for the provided English q-lines.
      const map = {
        '"I regret to inform you that" starts a letter indicating': '\"I regret to inform you that\" দিয়ে শুরু হওয়া চিঠি কী নির্দেশ করে',
        "Correction in: 'Another baffling change that I notice in him nowadays is that he avoids to speak to me.'": "উপরোক্ত বাক্যে কোন অংশটি ভুল আছে",
        " 'Write an abstract of this essay.' meaning of underlined word": " 'Write an abstract of this essay.'-এ underlined শব্দের অর্থ কী",
        "Choose the correct sentence": "সঠিক বাক্যটি নির্ধারণ করুন",
        "'Would you mind moving the car?' this sentence is a": " 'Would you mind moving the car?' এই বাক্যটি কোন ধরনের",
        "'What is the time _ your watch?' correct preposition is": " 'What is the time _ your watch?'-এ সঠিক preposition কোনটি",
        "Correction in: 'I will try to be on time but do not worry when I am late.'": "উপরোক্ত বাক্যে কোন অংশটি ভুল",
        "Meaning of 'humble' here is": "'humble' শব্দের এখানে অর্থ কী",
        "Synonym for the verb in 'One or two stars were still in the sky.'": "'One or two stars were still in the sky.' বাক্যে যে verb-এর সমার্থকী কী",
        "Sentence type of 'The boys who wanted to play football were disappointed when it rained.'": "উপরোক্ত বাক্যটি কী ধরনের বাক্য",
        "Antonym of 'trivial' is": "'trivial' শব্দের বিপরীতার্থক শব্দ",
        "A group of elephants is called": "হাতিদের একটি দলকে কী বলা হয়",
        "Choose the correct sentence": "সঠিক বাক্যটি কোনটি",
        "Rahim's doctor advised him to _ as a cure for his sore throat.": "Rahim-এর ডাক্তারের পরামর্শ কী ছিল",
        "In place of underlined part, correct phrasal verb is": "উপরোক্ত underlined অংশের পরিবর্তে সঠিক phrasal verb কোনটি",
        "NASA-এর spacecraft orbiting Jupiter is": "Jupiter-এর কক্ষে ঘোরাচ্ছে NASA-এর কোন মহাকাশযান",
      };
      // try to match a key; otherwise return original ( Bengali ) or empty line
      for(const k in map){
        if(orig.includes(k) || k.includes(orig) || orig.includes(k.split(' ')[0])) return map[k];
      }
      // fallback: return the same question (likely already Bengali)
      return orig;
    }

    // elements
    const startBtn = document.getElementById('startBtn');
    const timerEl = document.getElementById('timer');
    const statusEl = document.getElementById('status');
    const submitBtn = document.getElementById('submitBtn');
    const timeTakenEl = document.getElementById('timeTaken');
    const marksEl = document.getElementById('marksScored');
    const attemptedTop = document.getElementById('attempted');
    const correctTop = document.getElementById('correctCountTop');
    const wrongTop = document.getElementById('wrongCountTop');
    const totalQEl = document.getElementById('totalQ');

    totalQEl.textContent = quiz.length;

    let totalSeconds = 60*60, timerInterval=null, startTime=null, ended=false;

    function formatMMSS(s){ const m=Math.floor(s/60).toString().padStart(2,'0'); const sec=(s%60).toString().padStart(2,'0'); return `${m}:${sec}`; }

    function updateAttemptCounts(){
      let attempted=0;
      quiz.forEach((_,i)=>{
        const el = document.querySelector(`input[name="q${i+1}"]:checked`);
        if(el) attempted++;
      });
      attemptedTop.textContent = attempted;
    }

    container.addEventListener('change', (e)=>{ if(e.target && e.target.matches('input[type="radio"]')) updateAttemptCounts(); });

    function updateTimerDisplay(){
      const elapsed = Math.floor((Date.now()-startTime)/1000);
      const remaining = Math.max(0, totalSeconds - elapsed);
      timerEl.textContent = formatMMSS(remaining);
      if(remaining<=0){ clearInterval(timerInterval); finishQuiz(true); }
    }

    startBtn.addEventListener('click', ()=>{
      if(startTime) return;
      startTime = Date.now();
      statusEl.textContent='Running';
      submitBtn.disabled=false;
      startBtn.disabled=true;
      updateTimerDisplay();
      timerInterval = setInterval(updateTimerDisplay,250);
    });

    document.getElementById('quizForm').addEventListener('submit', function(e){
      e.preventDefault(); finishQuiz(false);
    });

    function finishQuiz(autoSubmit){
      if(ended) return; ended=true;
      if(timerInterval) clearInterval(timerInterval);
      const endedAt = Date.now();
      statusEl.textContent='Finished'; submitBtn.disabled=true;
      const effectiveStart = startTime || endedAt;
      const secondsTaken = Math.min(totalSeconds, Math.floor((endedAt-effectiveStart)/1000));
      const minutesTaken = (secondsTaken/60);
      timeTakenEl.textContent = minutesTaken.toFixed(2);

      let correct=0, wrong=0, attempted=0;
      quiz.forEach((item,i)=>{
        const qName='q'+(i+1);
        const chosenEl = document.querySelector(`input[name="${qName}"]:checked`);
        const chosenIdx = chosenEl ? Number(chosenEl.value) : null;
        const qSection = document.getElementById(qName);
        const labels = qSection.querySelectorAll('label.opt');
        labels.forEach(l=>{ l.classList.remove('is-correct','is-wrong'); l.style.opacity=''; });
        if(chosenIdx !== null){
          attempted++;
          if(chosenIdx === item.correctIndex){
            correct++;
            const sel = qSection.querySelector(`input[value="${chosenIdx}"]`);
            if(sel) sel.closest('label').classList.add('is-correct');
          } else {
            wrong++;
            const selWrong = qSection.querySelector(`input[value="${chosenIdx}"]`);
            if(selWrong) selWrong.closest('label').classList.add('is-wrong');
            const selCorrect = qSection.querySelector(`input[value="${item.correctIndex}"]`);
            if(selCorrect) selCorrect.closest('label').classList.add('is-correct');
          }
        } else {
          labels.forEach((l,idx)=>{ if(idx!==item.correctIndex) l.style.opacity='0.8'; });
          const selCorrect = qSection.querySelector(`input[value="${item.correctIndex}"]`);
          if(selCorrect) selCorrect.closest('label').classList.add('is-correct');
        }
      });

      attemptedTop.textContent = attempted;
      correctTop.textContent = correct;
      wrongTop.textContent = wrong;
      marksEl.textContent = correct;
      document.getElementById('attemptedRes').textContent = attempted;
      document.getElementById('correctRes').textContent = correct;
      document.getElementById('wrongRes').textContent = wrong;
      document.getElementById('detailedMsg').textContent = `You scored ${correct} marks out of ${quiz.length}${autoSubmit? ' (auto-submitted when time ran out)':''}.`;
      document.getElementById('resultArea').style.display='block';
      document.getElementById('resultArea').scrollIntoView({behavior:'smooth'});
    }

    // live attempted updater
    setInterval(()=>{ if(!ended) updateAttemptCounts(); },700);

    // protect from accidental leave
    window.addEventListener('beforeunload', function(e){
      if(startTime && !ended){ e.preventDefault(); e.returnValue=''; }
    });
  </script>
</body>
</html>
```
