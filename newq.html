<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>বহুনির্বাচনী পরীক্ষা — 45 প্রশ্ন</title>
  <style>
    :root{
      --bg:#f7f9fc;
      --panel:#fff;
      --muted:#475569;
      --accent:#0063f7;
      --green:#1fa851;
      --red:#d93025;
    }
    *{box-sizing:border-box}
    body { font-family: "Helvetica Neue", Arial, sans-serif; margin:0; background:var(--bg); color:#111; }
    /* Sticky top bar */
    .topbar {
      position: sticky;
      top: 0;
      z-index: 9999;
      background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,252,255,0.98));
      border-bottom: 1px solid #e6eef8;
      padding: 10px 16px;
      display:flex;
      align-items:center;
      gap:16px;
      box-shadow: 0 2px 6px rgba(18,38,63,0.03);
    }
    .title {
      display:flex;
      align-items:flex-start;
      gap:12px;
      min-width: 260px;
    }
    h1 { margin:0; font-size:18px; line-height:1.1; }
    .badges {
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .badge {
      background:var(--panel);
      border:1px solid #e1e6ee;
      padding:8px 10px;
      border-radius:8px;
      font-weight:600;
      font-size:13px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }
    /* put Start button to the far right inside topbar */
    .top-actions { margin-left:auto; display:flex; gap:8px; align-items:center; }
    .btn {
      padding:8px 12px;
      border-radius:8px;
      border:1px solid #cbd5e1;
      background:#fff;
      cursor:pointer;
      font-weight:700;
    }
    .btn.primary { background:var(--accent); color:#fff; border-color:var(--accent); }
    /* main content */
    main { max-width:980px; margin:18px auto; padding:0 16px 80px; }
    .panel { background:var(--panel); border:1px solid #e6eef8; border-radius:10px; padding:14px; box-shadow:0 6px 18px rgba(15,30,60,0.03); }
    form { margin-top:12px; }
    .question { margin:12px 0; padding:12px; border-radius:8px; background:linear-gradient(180deg,#fff,#fbfdff); border:1px solid #eef3fa; }
    .qnum { font-weight:700; margin-bottom:6px; }
    .options label { display:block; margin:6px 0; cursor:pointer; padding:6px 8px; border-radius:6px; transition:all .12s; }
    .options input { margin-right:8px; }
    .correct { background:#e6ffea; border:1px solid var(--green); color:#063; }
    .wrong { background:#ffecec; border:1px solid var(--red); color:#800; }
    .reveal-correct { outline:2px solid var(--green); border-radius:6px; }
    /* bottom controls box always visible when scrolling (sticky footer-like) */
    .bottombar {
      position: fixed;
      right: 16px;
      bottom: 16px;
      z-index: 9999;
      display:flex;
      gap:12px;
      align-items:center;
      background: linear-gradient(180deg,#fff,#fbfdff);
      border:1px solid #e6eef8;
      padding:10px;
      border-radius:10px;
      box-shadow: 0 8px 30px rgba(10,20,40,0.08);
    }
    .resultsBox { min-width:220px; background:transparent; display:flex; gap:12px; align-items:center; }
    .resultsBox div { font-weight:700; color:var(--muted); }
    .small { font-size:13px; color:var(--muted); }
    /* responsive */
    @media (max-width:720px){
      .topbar { flex-wrap:wrap; gap:10px; padding:12px; }
      .title { min-width:auto; }
      .badges { gap:6px; }
      .bottombar { left:16px; right:16px; justify-content:space-between; }
    }
  </style>
</head>
<body>
  <!-- sticky header with badges and Start button aligned to right -->
  <div class="topbar" role="banner" aria-label="Exam header">
    <div class="title">
      <div>
        <h1>বহুনির্বাচনী পরীক্ষা — 45 প্রশ্ন</h1>
        <div class="small" style="margin-top:4px;color:#55606b">Start Timer 60:00</div>
      </div>
    </div>

    <div class="badges" aria-hidden="false">
      <div class="badge">Total Questions: <strong style="margin-left:6px">45</strong></div>
      <div class="badge">Attempted: <strong id="attempted" style="margin-left:6px">0</strong></div>
      <div class="badge">Correct: <strong id="correct" style="margin-left:6px">0</strong></div>
      <div class="badge">Wrong: <strong id="wrong" style="margin-left:6px">0</strong></div>
    </div>

    <div class="top-actions">
      <button id="startBtn" class="btn primary">Start</button>
      <button id="pauseBtn" class="btn">Pause</button>
    </div>
  </div>

  <main>
    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
        <div class="small">Time taken (minutes): <span id="timeTaken">0.00</span></div>
        <div class="small">Marks scored: <span id="marksScored">0</span></div>
      </div>

      <form id="quizForm" autocomplete="off">
        <!-- For brevity include a representative set of questions; in real use paste all 45 unique questions -->
        <!-- Question 1 -->
        <div class="question" data-answer="B">
          <div class="qnum">1. মানুষের রক্তের প্রধান গঠন উপাদান কোনটি?</div>
          <div class="options">
            <label><input type="radio" name="q1" value="A"> A. প্লেটলেট</label>
            <label><input type="radio" name="q1" value="B"> B. লাল রক্ত কণিকা</label>
            <label><input type="radio" name="q1" value="C"> C. প্লাজমা</label>
            <label><input type="radio" name="q1" value="D"> D. লিউকোসাইট</label>
          </div>
        </div>

        <!-- Question 2 -->
        <div class="question" data-answer="D">
          <div class="qnum">2. সূর্যের নিকটতম গ্রহ কোনটি?</div>
          <div class="options">
            <label><input type="radio" name="q2" value="A"> A. মঙ্গল</label>
            <label><input type="radio" name="q2" value="B"> B. বৃহস্পতি</label>
            <label><input type="radio" name="q2" value="C"> C. শনির</label>
            <label><input type="radio" name="q2" value="D"> D. বুধ</label>
          </div>
        </div>

        <!-- Question 3 -->
        <div class="question" data-answer="A">
          <div class="qnum">3. জৈব রাসায়নে পানির সূত্র কী?</div>
          <div class="options">
            <label><input type="radio" name="q3" value="A"> A. H2O</label>
            <label><input type="radio" name="q3" value="B"> B. HO2</label>
            <label><input type="radio" name="q3" value="C"> C. H3O</label>
            <label><input type="radio" name="q3" value="D"> D. OH2</label>
          </div>
        </div>

        <!-- ... add all remaining questions up to 45 with same structure ... -->

        <!-- bottom controls inside main (Submit, Clear) -->
        <div style="margin-top:14px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <button type="button" id="submitBtn" class="btn primary">Submit Answers</button>
          <button type="button" id="clearBtn" class="btn">Clear Selections</button>
          <div class="small" style="margin-left:12px">Result: <span id="resultSummary">Not submitted</span></div>
        </div>

        <!-- visible results block under submit button -->
        <div id="resultsBox" class="resultsBox" style="margin-top:12px; display:none;">
          <div>Attempted: <span id="resAttempted">0</span></div>
          <div>Correct: <span id="resCorrect">0</span></div>
          <div>Wrong: <span id="resWrong">0</span></div>
        </div>
      </form>
    </div>
  </main>

  <!-- floating bottom-right box with quick view (also fixed) -->
  <div class="bottombar" aria-hidden="false">
    <div class="resultsBox">
      <div>Attempted: <span id="brAttempted">0</span></div>
      <div>Correct: <span id="brCorrect">0</span></div>
      <div>Wrong: <span id="brWrong">0</span></div>
    </div>
  </div>

  <script>
    (function(){
      // Timer
      const startBtn = document.getElementById('startBtn');
      const pauseBtn = document.getElementById('pauseBtn');
      const submitBtn = document.getElementById('submitBtn');
      const clearBtn = document.getElementById('clearBtn');

      const attempted = document.getElementById('attempted');
      const correct = document.getElementById('correct');
      const wrong = document.getElementById('wrong');
      const brAttempted = document.getElementById('brAttempted');
      const brCorrect = document.getElementById('brCorrect');
      const brWrong = document.getElementById('brWrong');

      const resAttempted = document.getElementById('resAttempted');
      const resCorrect = document.getElementById('resCorrect');
      const resWrong = document.getElementById('resWrong');
      const resultsBox = document.getElementById('resultsBox');
      const resultSummary = document.getElementById('resultSummary');
      const timeTakenSpan = document.getElementById('timeTaken');
      const marksScoredSpan = document.getElementById('marksScored');

      let totalSeconds = 60 * 60; // 60:00
      let interval = null;
      let running = false;
      let startedAt = null;

      function formatTime(sec){
        const m = Math.floor(sec/60).toString().padStart(2,'0');
        const s = (sec%60).toString().padStart(2,'0');
        return `${m}:${s}`;
      }
      function updateHeaderTimer(){
        // replace the small "Start Timer 60:00" text by updating the first small in topbar
        const small = document.querySelector('.topbar .small');
        if(small) small.textContent = running ? formatTime(totalSeconds) : `Start Timer ${formatTime(totalSeconds)}`;
      }
      function tick(){
        if(totalSeconds > 0){
          totalSeconds--;
          updateHeaderTimer();
        } else {
          stopTimer();
          evaluate(); // auto-submit
        }
      }
      function startTimer(){
        if(!running){
          running = true;
          if(!startedAt) startedAt = Date.now();
          interval = setInterval(tick,1000);
          updateHeaderTimer();
        }
      }
      function stopTimer(){
        running = false;
        clearInterval(interval);
        interval = null;
      }
      startBtn.addEventListener('click', ()=> startTimer());
      pauseBtn.addEventListener('click', ()=> running ? stopTimer() : startTimer());

      // randomize options while keeping track of correct text
      function shuffle(arr){
        for(let i = arr.length-1; i>0; i--){
          const j = Math.floor(Math.random()*(i+1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }
      function randomizeAllOptions(){
        const qDivs = Array.from(document.querySelectorAll('.question'));
        qDivs.forEach(q=>{
          const answerLetter = (q.dataset.answer || 'A').trim().toUpperCase();
          const idxMap = {A:0,B:1,C:2,D:3};
          const letterIndex = idxMap[answerLetter] ?? 0;
          const opts = Array.from(q.querySelectorAll('label')).map(label=>{
            const inp = label.querySelector('input');
            const text = label.textContent.replace(/^[A-D]\.\s*/,'').trim();
            return { text, name: inp.name };
          });
          const correctText = opts[letterIndex] ? opts[letterIndex].text : opts[0].text;
          q.dataset.correctText = correctText;
          const shuffled = shuffle(opts.slice());
          const container = q.querySelector('.options');
          container.innerHTML = '';
          shuffled.forEach((opt, i)=>{
            const input = document.createElement('input');
            input.type = 'radio';
            input.name = opt.name;
            input.value = String.fromCharCode(65+i);
            const label = document.createElement('label');
            label.appendChild(input);
            label.appendChild(document.createTextNode(' ' + String.fromCharCode(65+i) + '. ' + opt.text));
            container.appendChild(label);
          });
        });
      }

      // evaluate answers and highlight
      function evaluate(){
        // clear previous highlights
        document.querySelectorAll('.options label').forEach(l=> l.classList.remove('correct','wrong','reveal-correct'));
        const qDivs = Array.from(document.querySelectorAll('.question'));
        let att=0, corr=0, wrg=0;
        qDivs.forEach(q=>{
          const correctText = q.dataset.correctText;
          const radios = Array.from(q.querySelectorAll('input[type=radio]'));
          const labels = Array.from(q.querySelectorAll('label'));
          const sel = radios.find(r=> r.checked);
          if(sel) att++;
          // reveal correct label
          const cLabel = labels.find(l=> l.textContent.replace(/^[A-D]\.\s*/,'').trim() === correctText);
          if(cLabel) cLabel.classList.add('correct','reveal-correct');
          if(sel){
            const selLabel = sel.parentElement;
            const selText = selLabel.textContent.replace(/^[A-D]\.\s*/,'').trim();
            if(selText === correctText){
              corr++;
              selLabel.classList.add('correct');
            } else {
              wrg++;
              selLabel.classList.add('wrong');
              if(cLabel) cLabel.classList.add('correct');
            }
          }
        });
        attempted.textContent = att;
        correct.textContent = corr;
        wrong.textContent = wrg;
        brAttempted.textContent = att;
        brCorrect.textContent = corr;
        brWrong.textContent = wrg;
        resAttempted.textContent = att;
        resCorrect.textContent = corr;
        resWrong.textContent = wrg;
        resultsBox.style.display = 'flex';
        resultSummary.textContent = `${corr} correct, ${wrg} wrong, ${att} attempted`;
        marksScoredSpan.textContent = corr;
        stopTimer();
        const took = startedAt ? ((Date.now() - startedAt)/60000) : 0;
        timeTakenSpan.textContent = took.toFixed(2);
      }

      submitBtn.addEventListener('click', (e)=>{
        e.preventDefault();
        evaluate();
      });

      clearBtn.addEventListener('click', ()=>{
        if(!confirm('সব নির্বাচিত অপশন মুছতে চান?')) return;
        const inputs = document.querySelectorAll('input[type=radio]');
        inputs.forEach(i=> i.checked = false);
        document.querySelectorAll('.options label').forEach(l=> l.classList.remove('correct','wrong','reveal-correct'));
        attempted.textContent = 0;
        correct.textContent = 0;
        wrong.textContent = 0;
        brAttempted.textContent = 0;
        brCorrect.textContent = 0;
        brWrong.textContent = 0;
        resAttempted.textContent = 0;
        resCorrect.textContent = 0;
        resWrong.textContent = 0;
        resultsBox.style.display = 'none';
        resultSummary.textContent = 'Not submitted';
        marksScoredSpan.textContent = 0;
      });

      // live attempted update
      document.getElementById('quizForm').addEventListener('change', ()=>{
        const inputs = Array.from(document.querySelectorAll('input[type=radio]'));
        const names = new Set(inputs.filter(i=>i.checked).map(i=>i.name));
        attempted.textContent = names.size;
        brAttempted.textContent = names.size;
      });

      // initialize
      randomizeAllOptions();
      updateHeaderTimer();
    })();
  </script>
</body>
</html>
